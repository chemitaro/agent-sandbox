# Q-001: `/srv/mount` 配下に「trust したくない repo」が混ざる運用はありますか？

更新日: 2026-01-24  
関連: `@.spec-dock/current/requirement.md`（Q-001 / EC-001）

## 質問（回答してください）
`/srv/mount` 配下に **trust したくないリポジトリ（または未知のソース）**が混ざる運用はあり得ますか？

- 選択肢A: 混ざらない（`/srv/mount` は「信頼済み worktree 群」専用に運用する）
- 選択肢B: 混ざり得る（`/srv/mount` 配下に、信頼しない repo も置くことがある）

## なぜこの質問が重要か（意図）
今回の問題は、Codex の trust 判定が「親ディレクトリの trust を子に継承」する設計ではなく、**特定のキー（project root 等）に対する trust**で `.codex`（skills/rules/config）を有効化する挙動に起因します。

そのため、`projects."/srv/mount" = trusted` のように **`/srv/mount` を trust 境界として 1 点に集約**する案は、worktree が増えても trust が増殖しない点で非常に有力です。

一方で、この方式は「`/srv/mount` 配下にある `.codex` を信頼する」意味合いを持ちやすいため、**`/srv/mount` の中身が“信頼してよいものだけ”かどうか**が、セキュリティ/運用の前提になります。

## 選択肢の整理（Pros / Cons）

### A: 混ざらない（推奨になりやすい）
- Pros:
  - trust を **`/srv/mount` の 1 件**に集約でき、増殖しない
  - worktree の追加/削除に伴う設定変更が不要
  - 実装が単純になりやすい（環境側で project root を固定するだけで済む）
- Cons / 注意:
  - 運用として「`/srv/mount` は信頼済み領域」と割り切る必要がある

### B: 混ざり得る
- Pros:
  - ディレクトリ運用の自由度が高い（何でも置ける）
- Cons / 注意:
  - `/srv/mount` を一括 trust すると、混在する repo の `.codex` まで trust 対象になり得る
  - 結果として、**“trust 増殖を避ける”目標と衝突**しやすい
  - 追加対策（例外的 untrusted、専用サブディレクトリ分離、起動時の denylist 等）が必要になり、設計が複雑化する

## 回答欄（記入してください）
- 決定: **B（混ざり得る）**（ユーザー回答: 2026-01-24）
- 追加情報（ユーザー発言の要約）:
  - Git worktree と “それらを包含するディレクトリ” をマウントする運用上、`/srv/mount` に複数 repo/worktree が混在し得る
  - マウント対象は管理しており、危険なものは基本的に含めない想定
  - ただし「外部ツールが設定を機械的に増殖」するのは避けたい
  - Codex 側の正規の挙動で trust が増える（必要なら）ことは許容

## フォローアップ（B の場合だけ）
B を選ぶ場合、次のどれを許容できますか？（複数選択可）
- B1: `trusted` を `/srv/mount` ではなく “信頼済みサブディレクトリ” に限定する（例: `/srv/mount/workspace`）
- B2: `/srv/mount/<repo>` 単位で trust を持つ（増殖は許容するが、機械編集は避ける）
- B3: 明示的な denylist（untrusted 指定）を持つ（設定ファイルに例外を列挙）
- B4: 起動時の runtime overrides（`--config` 等）で trust を注入し、永続設定の増殖を避ける

### 追記（ユーザー意向のメモ）
- B1: 現実的に難しい想定
- B2: 許容（ただし “外部ツールの機械編集” は避けたい。Codex の正しい利用で増えるのは許容）
- B3: 条件付きで許容（ブラックリスト/denylist = untrusted 指定の意図なら許容し得る）
- B4: NG（外部注入は避けたい）
